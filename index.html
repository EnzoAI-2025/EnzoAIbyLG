<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enzo.AI ‚Äî Mini Intelig√™ncia Artificial</title>
  <style>
    :root{
      --bg:#0f1724;--card:#0b1220;--accent:#10b981;--muted:#94a3b8;--glass:rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,#071026 0%,#041421 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;transition:background .3s ease,color .3s ease}
    body.light{background:linear-gradient(180deg,#f0f4f8 0%,#d9e2ec 100%);color:#1e293b}
    .app{width:100%;max-width:940px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    header{display:flex;gap:12px;align-items:center}
    .logo{width:80px;height:80px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:22px;color:#fff;letter-spacing:-1px;text-shadow:0 0 12px rgba(16,185,129,0.6);box-shadow:0 0 15px rgba(16,185,129,0.15);overflow:hidden}
    .logo img{width:100%;height:100%;object-fit:cover}
    h1{margin:0;font-size:20px}
    p.lead{margin:4px 0 12px;color:var(--muted);font-size:13px}
    .chat{background:var(--card);border-radius:12px;padding:14px;min-height:320px;max-height:60vh;overflow:auto}
    body.light .chat{background:#fff}
    .msg{padding:10px 12px;margin-bottom:8px;border-radius:10px;max-width:78%}
    .user{background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));margin-left:auto;border-top-right-radius:2px}
    .bot{background:var(--glass);border:1px solid rgba(255,255,255,0.03)}
    .meta{font-size:11px;color:var(--muted);margin-bottom:6px}
    .controls{display:flex;gap:8px;margin-top:12px}
    input[type=text]{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
    button{padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#072018;font-weight:600;cursor:pointer;transition:opacity .2s ease}
    button:hover{opacity:0.85}
    .small{font-size:12px;color:var(--muted)}
    .suggestions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .chip{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
    footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
    .actions button{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 10px;border-radius:8px}
    .typing{display:inline-block;height:8px;width:36px}
    .result-source{font-size:11px;color:var(--muted);margin-top:6px}
    @media (max-width:820px){.app{padding:12px}.logo{width:60px;height:60px}}
  </style>
</head>
<body>
  <main class="app" role="main">
    <header>
      <div class="logo" id="logoWrap">
        <img src="/mnt/data/a971b6f1-c742-48dd-95f0-38eb4e1f535d.png" alt="EnzoIA Logo">
      </div>
      <div style="flex:1">
        <h1>Enzo.AI ‚Äî sua mini IA local</h1>
        <p class="lead">Interface futurista com voz, tema, busca integrada e respostas inteligentes.</p>
      </div>
      <button id="theme">Tema</button>
    </header>

    <section class="chat" id="chat" aria-live="polite"></section>

    <div class="suggestions" id="sugs">
      <div class="chip">Ol√°</div>
      <div class="chip">Pesquisar: Dom Pedro I</div>
      <div class="chip">Que dia √© hoje?</div>
      <div class="chip">Conte uma piada</div>
    </div>

    <div class="controls">
      <input id="input" type="text" placeholder="Digite sua mensagem..." />
      <button id="send">Enviar</button>
      <button id="voice">üéô</button>
      <button id="export">Exportar</button>
    </div>

    <footer>
      <div class="small">Enzo.AI ‚Äî Web Speech + OpenAI + SerpAPI</div>
      <div class="actions"><button id="clear">Limpar</button></div>
    </footer>
  </main>

  <script>
    // üîë CONFIGURA√á√ÉO DAS SUAS CHAVES DIRETO NO C√ìDIGO
    const OPENAI_API_KEY = "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";
    const SERPAPI_KEY = "d2db2d7515693bbc987e8b2bd143a815d76e0a8dd59c9f5c40aed1aff93986d1";

    // Elementos principais
    const chatEl = document.getElementById("chat");
    const input = document.getElementById("input");
    const send = document.getElementById("send");
    const clearBtn = document.getElementById("clear");
    const exportBtn = document.getElementById("export");
    const themeBtn = document.getElementById("theme");
    const voiceBtn = document.getElementById("voice");

    // Fun√ß√µes de utilidade
    function escapeHtml(t){return t.replace(/[&<>"]/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[m]));}
    function appendMessage(text,who="bot"){
      const msg=document.createElement("div");
      msg.className="msg "+(who==="user"?"user":"bot");
      msg.innerHTML=`<div class="meta">${who==="user"?"Voc√™":"Enzo.AI"}</div><div class="body">${text}</div>`;
      chatEl.appendChild(msg);
      chatEl.scrollTop=chatEl.scrollHeight;
      if(who==="bot") speak(msg.innerText);
    }

    // Voz
    function speak(text){if(!("speechSynthesis" in window))return;const u=new SpeechSynthesisUtterance(text);u.lang="pt-BR";window.speechSynthesis.speak(u);}
    const Rec = window.SpeechRecognition||window.webkitSpeechRecognition;
    if(Rec){const rec=new Rec();rec.lang="pt-BR";rec.onresult=e=>{input.value=e.results[0][0].transcript;send.click();};voiceBtn.onclick=()=>{rec.start();voiceBtn.textContent="üéß";setTimeout(()=>voiceBtn.textContent="üéô",2500);};}

    // Fun√ß√£o para buscar no Google via SerpAPI
    async function serpSearch(q){
      if(!SERPAPI_KEY || SERPAPI_KEY.includes("Coloque")) throw new Error("SerpAPI key ausente.");
      const params=new URLSearchParams({q,engine:"google",api_key:SERPAPI_KEY,hl:"pt",gl:"br"});
      const res=await fetch(`https://serpapi.com/search.json?${params}`);
      return await res.json();
    }

    // Fun√ß√£o para respostas com OpenAI
    async function openaiChat(prompt){
      if(!OPENAI_API_KEY || OPENAI_API_KEY.includes("Coloque")) throw new Error("OpenAI key ausente.");
      const body={model:"gpt-3.5-turbo",messages:[{role:"user",content:prompt}],max_tokens:500};
      const r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json","Authorization":"Bearer "+OPENAI_API_KEY},body:JSON.stringify(body)});
      const j=await r.json();
      return j.choices[0].message.content;
    }

    // L√≥gica principal
    async function handleUserMessage(txt){
      appendMessage(escapeHtml(txt),"user");
      const typing=showTyping();
      try{
        let reply;
        if(/pesquis/i.test(txt)){
          const query=txt.replace(/pesquis[ae]?:?/i,"").trim();
          const data=await serpSearch(query);
          reply=data.organic_results?.[0]?.snippet||"N√£o encontrei resultados.";
        }else{
          reply=await openaiChat(txt);
        }
        typing.remove();appendMessage(escapeHtml(reply).replace(/\n/g,"<br>"),"bot");
      }catch(e){typing.remove();appendMessage("Erro ao responder: "+e.message,"bot");}
    }

    function showTyping(){
      const el=document.createElement("div");
      el.className="msg bot";
      el.innerHTML='<div class="meta">Enzo.AI</div><div class="body"><span class="typing">‚óè‚óè‚óè</span></div>';
      chatEl.appendChild(el);
      chatEl.scrollTop=chatEl.scrollHeight;
      return el;
    }

    // A√ß√µes
    send.onclick=()=>{if(!input.value.trim())return;handleUserMessage(input.value.trim());input.value="";};
    input.onkeydown=e=>{if(e.key==="Enter"){send.click();}};
    clearBtn.onclick=()=>{chatEl.innerHTML="";appendMessage("Hist√≥rico limpo.","bot");};
    exportBtn.onclick=()=>{const text=[...chatEl.querySelectorAll(".msg")].map(m=>m.innerText).join("\n\n");const blob=new Blob([text],{type:"text/plain"});const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="conversa_enzoai.txt";a.click();};
    themeBtn.onclick=()=>{document.body.classList.toggle("light");};

    appendMessage("Ol√°! Eu sou o Enzo.AI. Digite ou fale algo para come√ßar.","bot");
  </script>
</body>
</html>
